<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç Kanban</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f172a, #581c87, #0f172a);
            color: white;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .kanban-board {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .column {
            background: rgba(30, 41, 59, 0.8);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(168, 85, 247, 0.3);
        }
        .column-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(168, 85, 247, 0.2);
        }
        .column-title {
            font-size: 18px;
            font-weight: 600;
        }
        .column-count {
            background: rgba(168, 85, 247, 0.3);
            color: #a855f7;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }
        .card {
            background: rgba(51, 65, 85, 0.8);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            border-left: 4px solid #ef4444;
        }
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        .priority-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            background: rgba(239, 68, 68, 0.2);
            color: #fca5a5;
        }
        .sentiment {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            color: #10b981;
        }
        .card-content {
            margin-bottom: 12px;
        }
        .card-text {
            font-size: 14px;
            line-height: 1.5;
            color: #d1d5db;
        }
        .card-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            font-size: 12px;
            color: #9ca3af;
        }
        .meta-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .test-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 20px 0;
        }
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }
        .status {
            padding: 8px 16px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: 600;
        }
        .status.success {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        .status.error {
            background: rgba(239, 68, 68, 0.2);
            color: #fca5a5;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß™ –¢–µ—Å—Ç Kanban API</h1>
            <p>–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–±–æ—Ç–∏ API —Ç–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö</p>
        </div>

        <button class="test-button" onclick="testAPI()">üîÑ –¢–µ—Å—Ç—É–≤–∞—Ç–∏ API</button>
        
        <div id="status"></div>
        <div id="results"></div>

        <div class="kanban-board" id="kanbanBoard" style="display: none;">
            <div class="column">
                <div class="column-header">
                    <div class="column-title">üïê –ó–∞–ø–∏—Ç</div>
                    <div class="column-count" id="requestCount">0</div>
                </div>
                <div id="requestColumn"></div>
            </div>

            <div class="column">
                <div class="column-header">
                    <div class="column-title">‚ö° –í–∏—Ä—ñ—à–µ–Ω–Ω—è</div>
                    <div class="column-count" id="processingCount">0</div>
                </div>
                <div id="processingColumn"></div>
            </div>

            <div class="column">
                <div class="column-header">
                    <div class="column-title">‚úÖ –ì–æ—Ç–æ–≤–æ</div>
                    <div class="column-count" id="doneCount">0</div>
                </div>
                <div id="doneColumn"></div>
            </div>
        </div>
    </div>

    <script>
        async function testAPI() {
            const statusDiv = document.getElementById('status');
            const resultsDiv = document.getElementById('results');
            const kanbanBoard = document.getElementById('kanbanBoard');
            
            statusDiv.innerHTML = '<div class="status">üîÑ –¢–µ—Å—Ç—É—î–º–æ API...</div>';
            resultsDiv.innerHTML = '';
            
            try {
                // –¢–µ—Å—Ç API
                const response = await fetch('http://localhost:3000/feedbacks/prioritized');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                statusDiv.innerHTML = '<div class="status success">‚úÖ API –ø—Ä–∞—Ü—é—î! –û—Ç—Ä–∏–º–∞–Ω–æ ' + data.length + ' –≤—ñ–¥–≥—É–∫—ñ–≤</div>';
                
                // –ü–æ–∫–∞–∑—É—î–º–æ Kanban –¥–æ—à–∫—É
                kanbanBoard.style.display = 'grid';
                
                // –†–æ–∑–ø–æ–¥—ñ–ª—è—î–º–æ –≤—ñ–¥–≥—É–∫–∏ –ø–æ —Å—Ç–æ–≤–ø—Ü—è—Ö
                const requestColumn = document.getElementById('requestColumn');
                const processingColumn = document.getElementById('processingColumn');
                const doneColumn = document.getElementById('doneColumn');
                
                let requestCount = 0;
                let processingCount = 0;
                let doneCount = 0;
                
                data.forEach(feedback => {
                    const card = createCard(feedback);
                    
                    if (feedback.status === '–ó–∞–ø–∏—Ç') {
                        requestColumn.appendChild(card);
                        requestCount++;
                    } else if (feedback.status === '–í–∏—Ä—ñ—à–µ–Ω–Ω—è') {
                        processingColumn.appendChild(card);
                        processingCount++;
                    } else if (feedback.status === '–ì–æ—Ç–æ–≤–æ') {
                        doneColumn.appendChild(card);
                        doneCount++;
                    }
                });
                
                // –û–Ω–æ–≤–ª—é—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫–∏
                document.getElementById('requestCount').textContent = requestCount;
                document.getElementById('processingCount').textContent = processingCount;
                document.getElementById('doneCount').textContent = doneCount;
                
                // –ü–æ–∫–∞–∑—É—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                resultsDiv.innerHTML = `
                    <div class="status success">
                        üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:<br>
                        ‚Ä¢ –í—Å—å–æ–≥–æ: ${data.length}<br>
                        ‚Ä¢ –ó–∞–ø–∏—Ç: ${requestCount}<br>
                        ‚Ä¢ –í–∏—Ä—ñ—à–µ–Ω–Ω—è: ${processingCount}<br>
                        ‚Ä¢ –ì–æ—Ç–æ–≤–æ: ${doneCount}
                    </div>
                `;
                
            } catch (error) {
                statusDiv.innerHTML = '<div class="status error">‚ùå –ü–æ–º–∏–ª–∫–∞: ' + error.message + '</div>';
                console.error('–ü–æ–º–∏–ª–∫–∞ API:', error);
            }
        }
        
        function createCard(feedback) {
            const card = document.createElement('div');
            card.className = 'card';
            
            const priorityColor = feedback.priority === 'high' ? '#ef4444' : 
                                 feedback.priority === 'medium' ? '#f59e0b' : '#6b7280';
            
            const sentimentIcon = feedback.sentiment === 'positive' ? 'üòä' : 
                                 feedback.sentiment === 'negative' ? 'üò†' : 'üòê';
            
            card.innerHTML = `
                <div class="card-header">
                    <div class="sentiment">${sentimentIcon} ${feedback.sentiment}</div>
                    <div class="priority-badge" style="background: ${priorityColor}20; color: ${priorityColor}">
                        ${feedback.priority === 'high' ? '–í–∏—Å–æ–∫–∏–π' : 
                          feedback.priority === 'medium' ? '–°–µ—Ä–µ–¥–Ω—ñ–π' : '–ù–∏–∑—å–∫–∏–π'}
                    </div>
                </div>
                <div class="card-content">
                    <div class="card-text">${feedback.text}</div>
                </div>
                <div class="card-meta">
                    <div class="meta-item">üë§ ${feedback.author}</div>
                    <div class="meta-item">üìÖ ${new Date(feedback.date).toLocaleDateString('uk-UA')}</div>
                    <div class="meta-item">üìç ${feedback.source}</div>
                    <div class="meta-item">üëç ${feedback.likes}</div>
                    <div class="meta-item">üè∑Ô∏è ${feedback.category}</div>
                </div>
            `;
            
            return card;
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ç–µ—Å—Ç—É—î–º–æ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
        window.addEventListener('load', () => {
            setTimeout(testAPI, 1000);
        });
    </script>
</body>
</html>

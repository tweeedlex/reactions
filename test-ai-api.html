<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç AI API</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: white;
        }
        .section {
            background: #2a2a2a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border: 1px solid #444;
        }
        .success { color: #4ade80; }
        .error { color: #f87171; }
        .loading { color: #fbbf24; }
        button {
            background: #6366f1;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #4f46e5; }
        textarea {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #444;
            border-radius: 4px;
            background: #333;
            color: white;
            min-height: 100px;
        }
        .result {
            margin-top: 10px;
            padding: 15px;
            border-radius: 8px;
            background: #333;
            border-left: 4px solid #6366f1;
        }
        .tone-professional { border-left-color: #3b82f6; }
        .tone-friendly { border-left-color: #10b981; }
        .tone-apologetic { border-left-color: #f59e0b; }
        .tone-grateful { border-left-color: #8b5cf6; }
    </style>
</head>
<body>
    <h1>ü§ñ –¢–µ—Å—Ç AI API</h1>
    
    <div class="section">
        <h2>üìù –¢–µ—Å—Ç –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π</h2>
        <textarea id="feedbackText" placeholder="–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç –≤—ñ–¥–≥—É–∫—É –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è AI...">–î—É–∂–µ –¥–æ–≤–≥–æ —á–µ–∫–∞–ª–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è, –∞–ª–µ —Ç–æ–≤–∞—Ä —á—É–¥–æ–≤–∏–π. –†–µ–∫–æ–º–µ–Ω–¥—É—é!</textarea>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 10px 0;">
            <select id="sentiment" style="padding: 8px; background: #333; color: white; border: 1px solid #444; border-radius: 4px;">
                <option value="positive">–ü–æ–∑–∏—Ç–∏–≤–Ω–∏–π</option>
                <option value="negative">–ù–µ–≥–∞—Ç–∏–≤–Ω–∏–π</option>
                <option value="neutral">–ù–µ–π—Ç—Ä–∞–ª—å–Ω–∏–π</option>
            </select>
            <select id="source" style="padding: 8px; background: #333; color: white; border: 1px solid #444; border-radius: 4px;">
                <option value="playstore">Google Play</option>
                <option value="instagram">Instagram</option>
                <option value="googlemaps">Google Maps</option>
            </select>
        </div>
        <button onclick="testAI()">–ì–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å</button>
        <div id="aiResult" class="result" style="display: none;"></div>
    </div>

    <div class="section">
        <h2>üß™ –®–≤–∏–¥–∫—ñ —Ç–µ—Å—Ç–∏</h2>
        <button onclick="testPositive()">–¢–µ—Å—Ç –ø–æ–∑–∏—Ç–∏–≤–Ω–æ–≥–æ –≤—ñ–¥–≥—É–∫—É</button>
        <button onclick="testNegative()">–¢–µ—Å—Ç –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ–≥–æ –≤—ñ–¥–≥—É–∫—É</button>
        <button onclick="testQuestion()">–¢–µ—Å—Ç –ø–∏—Ç–∞–Ω–Ω—è</button>
        <button onclick="testComplaint()">–¢–µ—Å—Ç —Å–∫–∞—Ä–≥–∏</button>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:3000';

        async function testAI() {
            const text = document.getElementById('feedbackText').value;
            const sentiment = document.getElementById('sentiment').value;
            const source = document.getElementById('source').value;
            const resultDiv = document.getElementById('aiResult');
            
            if (!text.trim()) {
                alert('–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç –≤—ñ–¥–≥—É–∫—É');
                return;
            }

            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<span class="loading">–ì–µ–Ω–µ—Ä—É—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å...</span>';

            try {
                const response = await fetch(`${API_BASE_URL}/ai/generate-response`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        text: text,
                        sentiment: sentiment,
                        source: source,
                        author: '–¢–µ—Å—Ç–æ–≤–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á',
                        category: '–∑–∞–≥–∞–ª—å–Ω–∏–π'
                    })
                });

                const data = await response.json();
                
                if (response.ok) {
                    const toneClass = `tone-${data.tone}`;
                    resultDiv.className = `result ${toneClass}`;
                    resultDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <strong class="success">‚úÖ AI –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∞!</strong>
                            <span style="background: #444; padding: 4px 8px; border-radius: 12px; font-size: 12px;">
                                ${Math.round(data.confidence * 100)}% –≤–ø–µ–≤–Ω–µ–Ω–æ—Å—Ç—ñ
                            </span>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <strong>–¢–æ–Ω:</strong> ${getToneText(data.tone)} | 
                            <strong>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è:</strong> ${getCategoryText(data.category)}
                        </div>
                        <div style="background: #2a2a2a; padding: 15px; border-radius: 6px; border-left: 4px solid #6366f1;">
                            <strong>–í—ñ–¥–ø–æ–≤—ñ–¥—å:</strong><br>
                            ${data.suggestion}
                        </div>
                        <button onclick="copyResponse('${data.suggestion.replace(/'/g, "\\'")}')" style="margin-top: 10px; background: #8b5cf6;">
                            üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
                        </button>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <span class="error">‚ùå –ü–æ–º–∏–ª–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó</span><br>
                        <strong>–ü–æ–º–∏–ª–∫–∞:</strong> ${data.message || '–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞'}
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <span class="error">‚ùå –ü–æ–º–∏–ª–∫–∞ –∑'—î–¥–Ω–∞–Ω–Ω—è</span><br>
                    <strong>–î–µ—Ç–∞–ª—ñ:</strong> ${error.message}
                `;
            }
        }

        function testPositive() {
            document.getElementById('feedbackText').value = '–î—É–∂–µ —á—É–¥–æ–≤–∏–π –¥–æ–¥–∞—Ç–æ–∫! –î—è–∫—É—é —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞–º –∑–∞ —Ç–∞–∫—É –∫–æ—Ä–∏—Å–Ω—É –ø—Ä–æ–≥—Ä–∞–º—É. –†–µ–∫–æ–º–µ–Ω–¥—É—é –≤—Å—ñ–º!';
            document.getElementById('sentiment').value = 'positive';
            testAI();
        }

        function testNegative() {
            document.getElementById('feedbackText').value = '–ü–æ–≥–∞–Ω–æ –ø—Ä–∞—Ü—é—î, –ø–æ—Å—Ç—ñ–π–Ω–æ –∑–∞–≤–∏—Å–∞—î. –ö–æ–ª–∏ –≤–∏–ø—Ä–∞–≤–ª—è—Ç—å —Ü—ñ –±–∞–≥–∏?';
            document.getElementById('sentiment').value = 'negative';
            testAI();
        }

        function testQuestion() {
            document.getElementById('feedbackText').value = '–ß–∏ —î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó? –ö–æ–ª–∏ –æ—á—ñ–∫—É–≤–∞—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è?';
            document.getElementById('sentiment').value = 'neutral';
            testAI();
        }

        function testComplaint() {
            document.getElementById('feedbackText').value = '–°–∫–∞—Ä–∂—É—Å—è –Ω–∞ –ø–æ–≥–∞–Ω–∏–π —Å–µ—Ä–≤—ñ—Å! –î–æ–≤–≥–æ —á–µ–∫–∞–≤ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, –∞–ª–µ —Ç–∞–∫ —ñ –Ω–µ –æ—Ç—Ä–∏–º–∞–≤.';
            document.getElementById('sentiment').value = 'negative';
            testAI();
        }

        function getToneText(tone) {
            const tones = {
                'professional': '–ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π',
                'friendly': '–î—Ä—É–∂–Ω—ñ–π', 
                'apologetic': '–í–∏–±–∞—á–ª–∏–≤–∏–π',
                'grateful': '–í–¥—è—á–Ω–∏–π'
            };
            return tones[tone] || tone;
        }

        function getCategoryText(category) {
            const categories = {
                'complaint': '–°–∫–∞—Ä–≥–∞',
                'praise': '–ü–æ—Ö–≤–∞–ª–∞',
                'question': '–ü–∏—Ç–∞–Ω–Ω—è',
                'suggestion': '–ü—Ä–æ–ø–æ–∑–∏—Ü—ñ—è'
            };
            return categories[category] || category;
        }

        async function copyResponse(text) {
            try {
                await navigator.clipboard.writeText(text);
                alert('–í—ñ–¥–ø–æ–≤—ñ–¥—å —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º—ñ–Ω—É!');
            } catch (err) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è:', err);
            }
        }
    </script>
</body>
</html>
